# Chaos Engineering Platform

AWS CDKã‚’ä½¿ç”¨ã—ãŸChaos Engineeringãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚Bedrockã«ã‚ˆã‚‹ã‚·ãƒŠãƒªã‚ªç”Ÿæˆã‹ã‚‰FISå®Ÿè¡Œã¾ã§ã€ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã®è‡ªå‹•åŒ–ã‚’æä¾›ã—ã¾ã™ã€‚

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

1. **ã‚·ãƒŠãƒªã‚ªç”Ÿæˆ** (`lambdas/scenario-generator/`)
   - Bedrock (Claude) ã‚’ä½¿ç”¨ã—ãŸã‚«ã‚ªã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã‚·ãƒŠãƒªã‚ªã®ç”Ÿæˆ
   - S3ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ™ãƒ¼ã‚¹ã®æ§‹é€ åŒ–ç”Ÿæˆ

2. **ã‚·ãƒŠãƒªã‚ªåˆ†æ** (`lambdas/scenario-analyzer/`)
   - ç”Ÿæˆã•ã‚ŒãŸã‚·ãƒŠãƒªã‚ªã®åˆ†æã¨CDKã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
   - FISãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ç”Ÿæˆ

3. **ãƒ‡ãƒ—ãƒ­ã‚¤è‡ªå‹•åŒ–** (`lambdas/deployer/`)
   - CDKã‚³ãƒ¼ãƒ‰ã®è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
   - FISå®Ÿé¨“ã®å®Ÿè¡Œ

4. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚§ã‚¤ã‚·ãƒ³ã‚°ä½“é¨“ç’°å¢ƒ** ğŸ†•
   - **Web UI**: React + TypeScript + Tailwind CSS
   - **API Gateway**: RESTful API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
   - **é™çš„ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°**: S3 + CloudFront
   - **FIS ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: å®Ÿè¡ŒçŠ¶æ³ã®å¯è¦–åŒ–

### ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CloudFront    â”‚    â”‚   API Gateway   â”‚    â”‚   Lambda UI     â”‚
â”‚   (Frontend)    â”‚â”€â”€â”€â–¶â”‚   (REST API)    â”‚â”€â”€â”€â–¶â”‚   Handler       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   S3 Bucket     â”‚    â”‚  Step Functions â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   (Templates)   â”‚â—€â”€â”€â”€â”‚   (Workflow)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Lambda        â”‚    â”‚   Lambda        â”‚    â”‚   Lambda        â”‚
â”‚   Scenario Gen  â”‚    â”‚   Analyzer      â”‚    â”‚   Deployer      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### å‰ææ¡ä»¶

- AWS CLI v2
- Node.js v18+
- CDK v2
- Dockerï¼ˆLambda ãƒ¬ã‚¤ãƒ¤ãƒ¼ç”¨ï¼‰
- jqï¼ˆJSONå‡¦ç†ç”¨ï¼‰

### 1. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# CDKä¾å­˜é–¢ä¿‚
cd cdk
npm install

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä¾å­˜é–¢ä¿‚
cd ../src/frontend
npm install
```

### 2. è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# è‡ªå‹•ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ
./scripts/build-and-deploy.sh
```

ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä»¥ä¸‹ã‚’è‡ªå‹•å®Ÿè¡Œã—ã¾ã™ï¼š

1. **CDKã‚¤ãƒ³ãƒ•ãƒ©ã®ãƒ‡ãƒ—ãƒ­ã‚¤**
   - Lambdaé–¢æ•°ç¾¤
   - API Gateway
   - S3ãƒã‚±ãƒƒãƒˆ
   - CloudFrontãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

2. **API Gateway URLã®æŠ½å‡º**
   - CDKã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã‹ã‚‰è‡ªå‹•æŠ½å‡º

3. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ãƒ“ãƒ«ãƒ‰**
   - ç’°å¢ƒå¤‰æ•°ã®è‡ªå‹•è¨­å®š
   - React ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ“ãƒ«ãƒ‰

4. **é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ãƒ—ãƒ­ã‚¤**
   - S3ã¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
   - CloudFrontã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ç„¡åŠ¹åŒ–

### 3. æ‰‹å‹•ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆé–‹ç™ºç”¨ï¼‰

```bash
# CDKã®ã¿ãƒ‡ãƒ—ãƒ­ã‚¤
cd cdk
npm run deploy

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã¿ãƒ“ãƒ«ãƒ‰
cd ../src/frontend
npm run build
```

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### Web UI

ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†å¾Œã€ä»¥ä¸‹ã®URLã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ï¼š

- **Website URL**: `https://[cloudfront-domain].cloudfront.net`
- **API Gateway URL**: `https://[api-id].execute-api.[region].amazonaws.com`

#### æ©Ÿèƒ½

1. **ã‚·ãƒŠãƒªã‚ªä¸€è¦§** (`/scenarios`)
   - ç”Ÿæˆã•ã‚ŒãŸã‚·ãƒŠãƒªã‚ªã®ä¸€è¦§è¡¨ç¤º
   - æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½

2. **ã‚·ãƒŠãƒªã‚ªè©³ç´°** (`/scenarios/:id`)
   - ã‚·ãƒŠãƒªã‚ªã®è©³ç´°æƒ…å ±è¡¨ç¤º
   - CDKã‚³ãƒ¼ãƒ‰ã®è¡¨ç¤ºãƒ»ã‚³ãƒ”ãƒ¼

3. **FIS ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰** (`/fis`)
   - FISå®Ÿé¨“ã®å®Ÿè¡ŒçŠ¶æ³è¡¨ç¤º
   - ãƒ­ã‚°ã®ç¢ºèª

4. **å®Ÿè¡Œå±¥æ­´** (`/executions`)
   - Step Functionå®Ÿè¡Œå±¥æ­´ã®ç¢ºèª

### API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

| ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | ãƒ¡ã‚½ãƒƒãƒ‰ | èª¬æ˜ |
|---|---|---|
| `/scenarios` | GET | ã‚·ãƒŠãƒªã‚ªä¸€è¦§å–å¾— |
| `/scenarios/{id}` | GET | ã‚·ãƒŠãƒªã‚ªè©³ç´°å–å¾— |
| `/fis/experiments` | GET | FISå®Ÿé¨“ä¸€è¦§å–å¾— |
| `/fis/experiments/{id}` | GET | FISå®Ÿé¨“è©³ç´°å–å¾— |
| `/executions` | GET | Step Functionå®Ÿè¡Œå±¥æ­´å–å¾— |
| `/health` | GET | ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ |

## ğŸ› ï¸ é–‹ç™º

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™º

```bash
cd src/frontend

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# ãƒ“ãƒ«ãƒ‰
npm run build

# å‹ãƒã‚§ãƒƒã‚¯
npm run type-check
```

### Lambdaé–¢æ•°é–‹ç™º

```bash
# å„Lambdaé–¢æ•°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§
pip install -r requirements.txt
python handler.py
```

### CDKé–‹ç™º

```bash
cd cdk

# å‹ãƒã‚§ãƒƒã‚¯
npm run build

# ãƒ†ã‚¹ãƒˆ
npm run test

# ãƒ‡ãƒ—ãƒ­ã‚¤
npm run deploy
```

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
vibe-cdk/
â”œâ”€â”€ cdk/                           # CDKã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ constructs/
â”‚   â”‚   â”‚   â”œâ”€â”€ stepfunction-scenario-gen.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ api-gateway.ts     # ğŸ†• API Gatewayæ§‹æˆ
â”‚   â”‚   â”‚   â””â”€â”€ frontend-hosting.ts # ğŸ†• é™çš„ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°
â”‚   â”‚   â””â”€â”€ chaos-100-stack.ts
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ src/
â”‚   â””â”€â”€ frontend/                  # ğŸ†• React ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ components/        # React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚       â”‚   â”œâ”€â”€ contexts/          # React ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
â”‚       â”‚   â””â”€â”€ main.tsx
â”‚       â””â”€â”€ package.json
â”œâ”€â”€ lambdas/
â”‚   â”œâ”€â”€ scenario-generator/
â”‚   â”œâ”€â”€ scenario-analyzer/
â”‚   â”œâ”€â”€ deployer/
â”‚   â””â”€â”€ ui-handler/               # ğŸ†• UIç”¨API Lambda
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ build-and-deploy.sh       # ğŸ†• è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â””â”€â”€ README.md
```

## ğŸ”§ è¨­å®š

### ç’°å¢ƒå¤‰æ•°

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ (`.env`):
```env
VITE_API_URL=https://your-api-gateway-url
VITE_ENV=production
```

### CDKè¨­å®š

`cdk/cdk.json`:
```json
{
  "app": "npx ts-node --prefer-ts-exts bin/chaos-100.ts",
  "context": {
    "@aws-cdk/core:enableStackNameDuplicates": true
  }
}
```

## ğŸš¨ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

1. **CDK ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¨ãƒ©ãƒ¼**
   ```bash
   # æ¨©é™ç¢ºèª
   aws sts get-caller-identity
   
   # CDK Bootstrap
   cdk bootstrap
   ```

2. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼**
   ```bash
   # ä¾å­˜é–¢ä¿‚ã®å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
   cd src/frontend
   rm -rf node_modules package-lock.json
   npm install
   ```

3. **API Gateway 404ã‚¨ãƒ©ãƒ¼**
   - Lambdaé–¢æ•°ã®ãƒ‡ãƒ—ãƒ­ã‚¤ç¢ºèª
   - CORSè¨­å®šã®ç¢ºèª
   - API Gateway ã‚¹ãƒ†ãƒ¼ã‚¸ã®ç¢ºèª

### ãƒ­ã‚°ã®ç¢ºèª

```bash
# Lambdaé–¢æ•°ã®ãƒ­ã‚°
aws logs tail /aws/lambda/[function-name] --follow

# API Gateway ã®ãƒ­ã‚°
aws logs tail /aws/apigateway/[api-id] --follow
```

## ğŸ¤ è²¢çŒ®

1. Fork the repository
2. Create a feature branch
3. Commit your changes
4. Push to the branch
5. Create a Pull Request

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License
